package com.vg.pdf;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileWriter;
import java.io.IOException;

import org.apache.pdfbox.cos.COSDocument;
import org.apache.pdfbox.pdfparser.PDFParser;
import org.apache.pdfbox.pdmodel.PDDocument;
import org.apache.pdfbox.util.PDFTextStripper;

public class Reconverter {
	 public void reconvertor(String inputWord, String outputFile) throws IOException{
		        PDFParser parser;
		        String parsedText = null;
		        PDFTextStripper pdfStripper = null;
		        PDDocument pdDoc = null;
		        COSDocument cosDoc = null;
		        File file = new File(inputWord);
		       
		        parser = new PDFParser(new FileInputStream(file));
		        try {
		            parser.parse();
		            cosDoc = parser.getDocument();
		            pdfStripper = new PDFTextStripper();
		            pdDoc = new PDDocument(cosDoc);
		            parsedText = pdfStripper.getText(pdDoc);
		        } catch (Exception e) {
		            System.err.println("An exception occured in parsing the PDF Document."+ e.getMessage());
		        } finally {
		            try {
		                if (cosDoc != null)
		                    cosDoc.close();
		                if (pdDoc != null)
		                    pdDoc.close();
		            } catch (Exception e) {
		                e.printStackTrace();
		            }
		        }

		            FileWriter fw = new FileWriter(file.getAbsoluteFile());
		            BufferedWriter bw = new BufferedWriter(fw);
		            bw.write(outputFile);
		            bw.close();

		            System.out.println("well done");
		 }
}